import{_ as k,aj as Q,r,N as c,k as _,al as j,t,m as d,q as s,B as u,y as m,z as P,w as V,Q as h,x as n,au as p,A as C,a3 as g,az as v,am as A}from"./index.379e16fb.js";import{Q as U,a as N}from"./QTable.d0631cdf.js";import{Q as w}from"./QSelect.4378271f.js";import{Q as z}from"./QPage.d25ede10.js";import{C as y}from"./ClosePopup.e5ad9c3d.js";import{a as f}from"./axios.7331a07d.js";import"./QList.114f449d.js";import"./QItem.d392d2f2.js";import"./format.3ff8b525.js";const b="https://posapi-test.factura-smart.com/",S=Q({name:"IndexPage",setup(){return{rows:r([]),cols:[{name:"id",align:"center",label:"ID",field:"id"},{name:"usuario",align:"center",label:"Usuario",field:"usuario"},{name:"clave",align:"center",label:"Clave",field:"clave"},{name:"nombre",align:"left",label:"Nombre",field:"nombre"},{name:"email",align:"left",label:"Email",field:"email"},{name:"empresa",align:"left",label:"Empresa",field:"empresa"},{name:"rol",align:"left",label:"Rol",field:"rol"},{name:"estatus",align:"left",label:"Estatus",field:"estatus"},{name:"accion",align:"left",label:"Accion",field:"accion"}],co_rol:r(sessionStorage.getItem("co_rol")),co_empresa:r(sessionStorage.getItem("co_empresa")),filterTable:r(""),buscaritem:r(!1),loading:r(!1),modalEdit:r(!1),modalCreate:r(!1),modalUpdEstatus:r(!1),usuario:r(""),clave:r(""),nombre:r(""),email:r(""),modelrol:r(""),optionsrol:r([]),modelsede:r(""),optionssede:r([]),pagination:{page:1,rowsPerPage:20}}},methods:{listarSedes(){f.get(b+"sede").then(async e=>{const l=e.data.data;this.optionssede=[];for(const o in l){const i={};i.cod=l[o].id,i.name=l[o].empresa,this.co_rol==="1"?this.optionssede.push(i):this.co_empresa===i.cod&&(this.optionssede.push(i),this.modelsede=this.optionssede[0])}}).catch(e=>{c.create("Problemas al listar Sedes "+e)})},listarRoles(){f.get(b+"usuario/roles").then(async e=>{const l=e.data.resp;this.optionsrol=[];for(const o in l){const i={};i.cod=l[o].id,i.name=l[o].rol,l[o].id==="1"?this.co_rol==="1"&&this.optionsrol.push(i):this.optionsrol.push(i)}}).catch(e=>{c.create("Problemas al listar Roles "+e)})},openCreate(){this.idUpd="",this.usuario="",this.clave="",this.email="",this.nombre="",this.modalCreate=!0},openEdit(e){console.log(e),this.idUpd=e.id,this.usuario=e.usuario,this.clave=e.clave,this.email=e.email,this.nombre=e.nombre,this.modalEdit=!0},crear(){console.log(this.modelrol),console.log(this.modelsede);const e={usuario:this.usuario||"",clave:this.clave||"",email:this.email||"",idrol:this.modelrol.cod,idempresa:this.modelsede.cod,nombre:this.nombre||""};f.post(b+"usuario/",e).then(async l=>{if(console.log(l.status),l.status===200){const o=l.data.resp;console.log(o),c.create(o),this.modalCreate=!1,this.listar()}}).catch(l=>{c.create("Problemas al actualizar Configuracion "+l)})},guardar(){const e={usuario:this.usuario||"",clave:this.clave||"",email:this.email||"",nombre:this.nombre||""};f.put(b+"usuario/"+this.idUpd,e).then(async l=>{if(console.log(l.status),l.status===200){const o=l.data.resp;console.log(o),c.create(o),this.modalEdit=!1,this.listar()}}).catch(l=>{c.create("Problemas al actualizar Configuracion "+l)})},btnOpenUpdEstatus(e){this.idUpd=e.id,this.messageActualizar=e.estatus==="1"?"desactivar":"activar",this.estatusAct=e.estatus,this.modalUpdEstatus=!0},actualizarEstatus(){const e={estatus:this.estatusAct==="1"?0:1};f.put(b+"usuario/estatus/"+this.idUpd,e).then(async l=>{if(l.status===200){const o=l.data.resp;console.log(o),c.create(o),this.modalUpdEstatus=!1,this.listar()}})},listar(){this.btndisable=!1,f.get(b+"usuario").then(async e=>{console.log(e.data);const l=e.data.resp;this.rows=[];for(const o in l){const i={};i.id=l[o].id,i.usuario=l[o].usuario,i.clave=l[o].clave,i.nombre=l[o].nombre,i.email=l[o].email,i.rol=l[o].rol,i.idrol=l[o].idrol,i.empresa=l[o].empresa,i.idempresa=l[o].idempresa,i.estatus=l[o].estatus,this.co_rol==="1"?this.rows.push(i):this.co_empresa===i.idempresa&&this.rows.push(i)}console.log(this.rows)}).catch(e=>{c.create("Problemas al listar Emisores "+e)})}},mounted(){console.log("Listar emisores"),this.listarSedes(),this.listarRoles(),this.listar()}}),T={class:"col"},I={class:"botonesU row",style:{background:"#ededed"}},$={style:{display:"inline"}},B={class:"listarcategorias row"},D={class:"listarcategoriasconitem col"},R={class:"row justify-center"},q=d("div",{class:"text-h6"},"Crear Usuario",-1),O={class:"row justify-around"},G={class:"row justify-around"},H={class:"row justify-around"},L={class:"row justify-around"},M=d("div",{class:"text-h6"},"Editar Usuario",-1),F={class:"row justify-around"},J={class:"row justify-around"},K=d("div",{class:"text-h6",style:{"text-align":"center"}},"Actualizar Estatus",-1),W={style:{display:"flex","justify-content":"space-evenly","margin-top":"20px"}};function X(e,l,o,i,Y,Z){return _(),j(z,{class:"bg-white row"},{default:t(()=>[d("div",T,[d("div",I,[d("div",$,[s(u,{"icon-right":"person_add",class:"q-ml-sm col-md-4 col-sm-3 col-xs-3",color:"secondary",label:"Crear Usuario",onClick:l[0]||(l[0]=a=>e.openCreate())})])]),d("div",B,[d("div",D,[d("div",R,[s(N,{dense:"",rows:e.rows,columns:e.cols,"row-key":"num",pagination:e.pagination,style:{width:"95%","margin-top":"20px"},loading:e.loading,filter:e.filterTable,"no-data-label":"No hay registros!"},{"top-left":t(()=>[s(m,{dense:"",debounce:"300",color:"primary",modelValue:e.filterTable,"onUpdate:modelValue":l[1]||(l[1]=a=>e.filterTable=a),placeholder:"Buscar"},{append:t(()=>[s(P,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-accion":t(a=>[s(U,{props:a},{default:t(()=>[d("div",null,[s(u,{color:"primary",icon:"group_remove",onClick:V(E=>e.openEdit(a.row),["stop"]),dense:""},null,8,["onClick"])])]),_:2},1032,["props"])]),"body-cell-estatus":t(a=>[s(U,{props:a},{default:t(()=>[d("div",null,[s(u,{color:a.row.estatus==="1"?"secondary":"negative",icon:a.row.estatus==="1"?"toggle_on":"toggle_off",onClick:V(E=>e.btnOpenUpdEstatus(a.row),["stop"]),dense:""},null,8,["color","icon","onClick"])])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading","filter"])])])])]),s(v,{modelValue:e.modalCreate,"onUpdate:modelValue":l[8]||(l[8]=a=>e.modalCreate=a),persistent:""},{default:t(()=>[s(h,{class:"col-md-6 col-sm-11 col-xs-11",style:{"margin-top":"20px"}},{default:t(()=>[s(n,{class:"row"},{default:t(()=>[q]),_:1}),s(p,{class:"row"}),s(n,null,{default:t(()=>[d("div",O,[s(m,{class:"col-md-6 col-sm-12 col-xs-12",filled:"",modelValue:e.usuario,"onUpdate:modelValue":l[2]||(l[2]=a=>e.usuario=a),label:"Usuario","stack-label":"",dense:"",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),s(m,{class:"col-md-5 col-sm-12 col-xs-12",filled:"",modelValue:e.clave,"onUpdate:modelValue":l[3]||(l[3]=a=>e.clave=a),label:"Clave","stack-label":"",dense:""},null,8,["modelValue"])])]),_:1}),s(p,{class:"row"}),s(n,null,{default:t(()=>[d("div",G,[s(m,{class:"col-md-4 col-sm-12 col-xs-12",filled:"",modelValue:e.nombre,"onUpdate:modelValue":l[4]||(l[4]=a=>e.nombre=a),label:"Nombre","stack-label":"",dense:"",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),s(m,{class:"col-md-7 col-sm-12 col-xs-12",filled:"",modelValue:e.email,"onUpdate:modelValue":l[5]||(l[5]=a=>e.email=a),label:"Email","stack-label":"",dense:""},null,8,["modelValue"])])]),_:1}),s(p,{class:"row"}),s(n,null,{default:t(()=>[d("div",H,[s(w,{dense:"",class:"col",filled:"","options-dense":"",modelValue:e.modelrol,"onUpdate:modelValue":l[6]||(l[6]=a=>e.modelrol=a),options:e.optionsrol,"option-label":"name","option-value":"cod",label:"Rol de usuario",style:{margin:"10px"}},null,8,["modelValue","options"])])]),_:1}),s(p,{class:"row"}),s(n,null,{default:t(()=>[d("div",L,[s(w,{dense:"",class:"col",filled:"","options-dense":"",modelValue:e.modelsede,"onUpdate:modelValue":l[7]||(l[7]=a=>e.modelsede=a),options:e.optionssede,"option-label":"name","option-value":"cod",label:"Emisores",style:{margin:"10px"}},null,8,["modelValue","options"])])]),_:1}),s(p),s(C,{align:"right"},{default:t(()=>[g(s(u,{label:"Cerrar",color:"negative"},null,512),[[y]]),s(u,{label:"Guardar",color:"secondary",onClick:e.crear},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(v,{modelValue:e.modalEdit,"onUpdate:modelValue":l[13]||(l[13]=a=>e.modalEdit=a),persistent:""},{default:t(()=>[s(h,{class:"col-md-6 col-sm-11 col-xs-11",style:{"margin-top":"20px"}},{default:t(()=>[s(n,{class:"row"},{default:t(()=>[M]),_:1}),s(p,{class:"row"}),s(n,null,{default:t(()=>[d("div",F,[s(m,{class:"col-md-6 col-sm-12 col-xs-12",filled:"",modelValue:e.usuario,"onUpdate:modelValue":l[9]||(l[9]=a=>e.usuario=a),label:"Usuario","stack-label":"",dense:"",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),s(m,{class:"col-md-5 col-sm-12 col-xs-12",filled:"",modelValue:e.clave,"onUpdate:modelValue":l[10]||(l[10]=a=>e.clave=a),label:"Clave","stack-label":"",dense:""},null,8,["modelValue"])])]),_:1}),s(p,{class:"row"}),s(n,null,{default:t(()=>[d("div",J,[s(m,{class:"col-md-4 col-sm-12 col-xs-12",filled:"",modelValue:e.nombre,"onUpdate:modelValue":l[11]||(l[11]=a=>e.nombre=a),label:"Nombre","stack-label":"",dense:"",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),s(m,{class:"col-md-7 col-sm-12 col-xs-12",filled:"",modelValue:e.email,"onUpdate:modelValue":l[12]||(l[12]=a=>e.email=a),label:"Email","stack-label":"",dense:""},null,8,["modelValue"])])]),_:1}),s(p),s(C,{align:"right"},{default:t(()=>[g(s(u,{label:"Cerrar",color:"negative"},null,512),[[y]]),s(u,{label:"Guardar",color:"secondary",onClick:e.guardar},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(v,{modelValue:e.modalUpdEstatus,"onUpdate:modelValue":l[14]||(l[14]=a=>e.modalUpdEstatus=a),persistent:""},{default:t(()=>[s(h,{style:{width:"250px"}},{default:t(()=>[s(n,null,{default:t(()=>[K]),_:1}),s(n,{class:"q-pt-none"},{default:t(()=>[d("div",null," \xBFDesea "+A(e.messageActualizar)+" este usuario? ",1)]),_:1}),s(n,{class:"q-pt-none"},{default:t(()=>[d("div",W,[g(s(u,{color:"negative",label:"Cancelar"},null,512),[[y]]),s(u,{color:"secondary",label:"Aceptar",onClick:e.actualizarEstatus},null,8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var re=k(S,[["render",X]]);export{re as default};
