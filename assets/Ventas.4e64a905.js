import{_ as T,a9 as P,r as c,N as w,k as u,l as F,w as r,q as t,m as i,z as x,a6 as Y,B as f,y as V,F as _,ab as o,t as N,Q as B,x as S,C as g,aw as h,ac as y,ay as M,ax as b,A,az as U}from"./index.0b5707ba.js";import{Q,a as j}from"./QPopupProxy.d52a711f.js";import{Q as v,a as $}from"./QTable.3a4ed94a.js";import{Q as k}from"./QBadge.d706b160.js";import{Q as q}from"./QPage.ef0d5ed6.js";import{C as D}from"./ClosePopup.75228d91.js";import{h as m}from"./moment.40bc58bf.js";import{a as C}from"./axios.7331a07d.js";import"./format.ef8154b2.js";import"./QSelect.55e2252e.js";import"./QItem.79c151f9.js";const I="https://posapi-test.factura-smart.com/",z=P({name:"IndexPage",setup(){const e=c(m().format("YYYY-MM-DD")),s=c(m().format("YYYY/MM/DD")),l=c(m().format("YYYY/MM/DD"));return{today:e,desde:s,hasta:l,modaldetalleinvoice:c(!1),prefijo:c("Bs."),prefijo2:c("$"),mostrartotal:c("1"),tipomoneda:c("1"),rows:c([]),ventas:c([]),cols:[{name:"accion",align:"left",label:"\u{1F527}Accion",field:"accion"},{name:"tipofactura",align:"center",label:"\u{1F4C3}Tipo",field:"tipofactura"},{name:"numerointerno",align:"center",label:"\u{1F522}N\xB0 Interno",field:"numerointerno"},{name:"numerocontrol",align:"center",label:"\u{1F50D}# Control",field:"numerocontrol"},{name:"fecha",align:"center",label:"\u{1F4C5}Fecha",field:"fecha"},{name:"cliente",align:"left",label:"\u{1F468}\u200D\u{1F4BC}Cliente",field:"cliente"},{name:"usuario",align:"left",label:"\u{1F464}Usuario",field:"usuario"},{name:"subtotal",align:"left",label:"\u{1F4B2}Subtotal",field:"subtotal"},{name:"impuesto",align:"left",label:"\u{1F3DB}Impuesto",field:"impuesto"},{name:"total",align:"center",label:"\u{1F4B5}Total",field:"total"},{name:"formadepago",align:"center",label:"\u{1F3DB}\uFE0FPago",field:"formadepago"},{name:"estatus",align:"center",label:"\u{1F504}Estatus",field:"estatus"}],filterTable:c(""),empresa:c(""),direccion:c(""),rif:c(""),telefono:c(""),email:c(""),buscaritem:c(!1),detalleventa:c({}),loading:c(!1),id_usuario:c(sessionStorage.getItem("id_usuario")),co_rol:c(sessionStorage.getItem("co_rol")),pagination:{page:1,rowsPerPage:20}}},methods:{imprimir(){window.frames.print_frame.document.body.innerHTML=document.getElementById("areaImprimir").innerHTML,window.frames.print_frame.window.focus(),window.frames.print_frame.window.print(),this.modaldetalleinvoice=!1},async abrirDetalleInvoive(e){console.log(e),this.detalleventa=e,await C.get(I+"ventas/getitemsventas/"+e.cod).then(async s=>{this.ventas=s.data.resp;for(const l in this.holds){const n=this.ventas[l];this.ventas.push(n)}}).catch(s=>{w.create("Problemas al listar items Ventas "+s)}),this.modaldetalleinvoice=!0},listar(){this.btndisable=!1;const e={idempresa:sessionStorage.getItem("co_empresa"),desde:m(this.desde,"YYYY/MM/DD").format("YYYY-MM-DD"),hasta:m(this.hasta,"YYYY/MM/DD").format("YYYY-MM-DD")};C.post(I+"ventas/getventas",e).then(async s=>{console.log(s.data);const l=s.data.resp;this.rows=[];for(const n in l){const d={};d.cod=l[n].id,d.numerointerno=l[n].numerointerno,d.numerocontrol=l[n].numerocontrol,d.fecha=m(l[n].fecha).format("DD/MM/YYYY HH:mm:ss"),d.subtotal=l[n].subtotal?l[n].subtotal.toFixed(2):"0.00",d.impuesto=l[n].impuesto?l[n].impuesto.toFixed(2):"0.00",d.total=l[n].total?l[n].total.toFixed(2):"0.00",d.totalusd=l[n].totalusd?l[n].totalusd.toFixed(2):"0.00",d.igtf=l[n].igtf?l[n].igtf.toFixed(2):"0.00",d.descuentos=l[n].descuentos,d.usuario=l[n].usuario,d.documentosolo=l[n].documento,d.documento=l[n].abrev+"-"+l[n].documento,d.cliente=l[n].nombrecliente,d.abrev=l[n].abrev,d.tipofactura=l[n].tipofactura,d.estatus=l[n].estatus,d.formadepago=l[n].formadepago,this.co_rol==="3"?l[n].idusuario===this.id_usuario&&this.rows.push(d):this.rows.push(d)}console.log(this.rows)}).catch(s=>{w.create("Problemas al listar Ventas "+s)})},async cargar(){const s=(await C.get(I+"configuracion/"+sessionStorage.getItem("co_empresa")).catch(l=>{w.create("Problemas al listar Configuracion "+l)})).data.resp;this.empresa=s.empresa,this.rif=s.rif,this.direccion=s.direccion,this.telefono=s.telefono,this.email=s.email,this.tipomoneda=s.tipomoneda,this.prefijo=s.tipomoneda==="1"?"Bs.":"$",this.prefijo2=s.tipomoneda==="1"?"$":"Bs.",this.mostrartotal=s.mostrartotal}},watch:{desde(e){this.listar()},hasta(e){this.listar()}},mounted(){this.cargar(),this.listar()}}),H={class:"col"},E=t("div",{class:"botones row fondo-gris shadow-up-9"},[t("h6",{class:"p-2"},"Reporte de Ventas")],-1),L={class:"listarcategorias row",style:{margin:"20px 0 10px 0"}},R={class:"col-md-2 col-sm-6 col-xs-12",style:{padding:"5px"}},G={class:"row items-center justify-end"},O={class:"col-md-2 col-sm-6 col-xs-12",style:{padding:"5px"}},J={class:"row items-center justify-end"},K={class:"col-md-3 col-sm-6 col-xs-12",style:{padding:"5px"}},W={class:"row",style:{height:"74vh",overflow:"auto"}},X={class:"col"},Z={class:"row justify-center"},tt={class:"text-left"},et=t("br",null,null,-1),at={class:"text-center"},ot={class:"text-center"},st={align:"center"},lt={id:"areaImprimir",style:{width:"100%"}},it={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},nt={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},rt={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},dt={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},ct={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},ut={key:0,class:"anulada",style:{display:"flex","justify-content":"center","align-items":"center",width:"100%"}},ht={style:{display:"flex","align-items":"left",width:"100%"}},mt={class:"numero",style:{"margin-left":"10px"}},ft={class:"numero",style:{"margin-left":"10px"}},pt={style:{display:"flex","align-items":"center"}},_t=t("div",{class:"control",style:{"margin-left":"10px"}}," N\xB0 de control:",-1),gt={class:"control",style:{"margin-left":"10px"}},yt={style:{width:"100%"}},bt={class:"letratotalesfactura",style:{"line-height":"10px"}},vt=t("td",{style:{width:"30%"}},"Raz\xF3n social:",-1),wt={style:{"font-weight":"bold"}},xt={class:"letratotalesfactura",style:{"line-height":"10px"}},Yt={style:{"font-weight":"bold"}},Vt={class:"letratotalesfactura",style:{"line-height":"10px"}},Dt=t("td",null,"Fecha:",-1),Ct={style:{"font-weight":"bold"}},It={class:"letratotalesfactura",style:{"line-height":"10px"}},Mt=t("td",null,"Cajero:",-1),Qt={style:{"font-weight":"bold"}},jt={style:{width:"100%"}},kt=t("tr",{style:{"font-weight":"bold","font-size":"11px"}},[t("td",{class:"rayafactura rayaarriba",style:{width:"130px"}},"Producto"),t("td",{class:"rayafactura rayaarriba",style:{"text-align":"right"}},"Precio"),t("td",{class:"rayafactura rayaarriba"},"Cant."),t("td",{class:"rayafactura rayaarriba"},"Imp %"),t("td",{class:"rayafactura rayaarriba",style:{"text-align":"right"}},"Total")],-1),Tt={style:{"font-size":"11px"}},Pt={style:{"text-align":"right"}},Ft={style:{"text-align":"center"}},Nt={style:{"text-align":"center"}},Bt={style:{"text-align":"right"}},St={key:0,style:{"line-height":"10px"}},At={style:{"font-style":"italic","font-size":"9px"}},Ut={key:0},$t=t("td",null,null,-1),qt=t("td",null,null,-1),zt=t("td",null,null,-1),Ht=t("td",null,null,-1),Et=t("tr",null,[t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"})],-1),Lt={style:{width:"100%"}},Rt={class:"letratotalesfactura",style:{"line-height":"10px"}},Gt=t("td",{style:{width:"40%"}},null,-1),Ot={style:{"text-align":"right"}},Jt={class:"letratotalesfactura",style:{"line-height":"10px"}},Kt=t("td",null,null,-1),Wt={style:{"text-align":"right"}},Xt={class:"letratotalesfactura",style:{"line-height":"10px"}},Zt=t("td",null,null,-1),te={style:{"text-align":"right"}},ee={class:"letratotalesfactura",style:{"line-height":"10px"}},ae=t("td",null,null,-1),oe={class:"rayafactura"},se={class:"rayafactura",style:{"text-align":"right"}},le={class:"letratotalesfactura",style:{"font-weight":"bold"}},ie=t("td",null,null,-1),ne={style:{"text-align":"right"}},re={key:0,class:"letratotalesfactura",style:{"font-weight":"bold"}},de=t("td",null,null,-1),ce={style:{"text-align":"right"}},ue=t("iframe",{name:"print_frame",width:"0",height:"0",frameborder:"0",src:"about:blank"},null,-1);function he(e,s,l,n,d,me){return u(),F(q,{class:"row"},{default:r(()=>[t("div",H,[E,t("div",L,[t("div",R,[i(V,{color:"blue-grey-3","bg-color":"white",outlined:"",standout:"",dense:"",debounce:"500",modelValue:e.desde,"onUpdate:modelValue":s[1]||(s[1]=a=>e.desde=a),label:"Desde"},{append:r(()=>[i(x,{name:"event",class:"cursor-pointer"},{default:r(()=>[i(Q,{"transition-show":"scale","transition-hide":"scale"},{default:r(()=>[i(j,{modelValue:e.desde,"onUpdate:modelValue":s[0]||(s[0]=a=>e.desde=a)},{default:r(()=>[t("div",G,[Y(i(f,{label:"Close",color:"primary",flat:""},null,512),[[D]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",O,[i(V,{color:"blue-grey-3","bg-color":"white",outlined:"",standout:"",dense:"",debounce:"500",modelValue:e.hasta,"onUpdate:modelValue":s[3]||(s[3]=a=>e.hasta=a),label:"Hasta"},{append:r(()=>[i(x,{name:"event",class:"cursor-pointer"},{default:r(()=>[i(Q,{"transition-show":"scale","transition-hide":"scale"},{default:r(()=>[i(j,{modelValue:e.hasta,"onUpdate:modelValue":s[2]||(s[2]=a=>e.hasta=a)},{default:r(()=>[t("div",J,[Y(i(f,{label:"Close",color:"primary",flat:""},null,512),[[D]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",K,[i(V,{color:"blue-grey-3","bg-color":"white",outlined:"",standout:"",dense:"",debounce:"500",modelValue:e.filterTable,"onUpdate:modelValue":s[4]||(s[4]=a=>e.filterTable=a),placeholder:"Buscar"},{append:r(()=>[i(x,{name:"search"})]),_:1},8,["modelValue"])])]),t("div",W,[t("div",X,[t("div",Z,[i($,{rows:e.rows,title:"Ventas",columns:e.cols,"row-key":"num",pagination:e.pagination,dense:"",style:{width:"95%",margin:"20px"},loading:e.loading,filter:e.filterTable,"no-data-label":"\u26A0 Sin registros ","wrap-cells":"",separator:"cell",class:"custom-shadow custom-border-radius-table"},{"body-cell-cliente":r(a=>[i(v,{props:a},{default:r(()=>[t("div",tt,[_(o(a.row.cliente)+" ",1),et,_(" "+o(a.row.documento),1)])]),_:2},1032,["props"])]),"body-cell-estatus":r(a=>[i(v,{props:a},{default:r(()=>[t("div",at,[i(k,{color:a.row.estatus==="1"?"green-1":"red-1","text-color":a.row.estatus==="1"?"green-9":"red-9",class:"q-mt-xs q-mr-xs q-pa-xs",rounded:""},{default:r(()=>[_(o(a.row.estatus==="1"?"Procesada":"Anulada"),1)]),_:2},1032,["color","text-color"])])]),_:2},1032,["props"])]),"body-cell-formadepago":r(a=>[i(v,{props:a},{default:r(()=>[t("div",ot,[i(k,{color:a.row.formadepago==="1"?"blue-1":"orange-1","text-color":a.row.formadepago==="1"?"blue-9":"orange-9",class:"q-mt-xs q-mr-xs q-pa-xs",rounded:""},{default:r(()=>[_(o(a.row.formadepago==="1"?"Contado":"Cr\xE9dito"),1)]),_:2},1032,["color","text-color"])])]),_:2},1032,["props"])]),"body-cell-accion":r(a=>[i(v,{props:a},{default:r(()=>[t("div",st,[i(f,{round:"",unelevated:"",color:"orange-1","text-color":"orange-10",icon:"plagiarism",dense:"",onClick:N(p=>e.abrirDetalleInvoive(a.row),["stop"])},null,8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading","filter"])])])])]),i(U,{modelValue:e.modaldetalleinvoice,"onUpdate:modelValue":s[5]||(s[5]=a=>e.modaldetalleinvoice=a),persistent:""},{default:r(()=>[i(B,{style:{width:"320px"}},{default:r(()=>[t("div",lt,[i(S,{style:{"justify-content":"center"}},{default:r(()=>[t("div",it,o(e.empresa),1),t("div",nt,o(e.rif),1),t("div",rt,o(e.direccion),1),t("div",dt,o(e.telefono),1),t("div",ct,o(e.email),1),i(g,{style:{margin:"10px 0px"}}),e.detalleventa.estatus==="2"?(u(),h("div",ut,"ANULADA")):y("",!0),t("div",ht,[t("div",mt,o(e.detalleventa.tipofactura),1),t("div",ft,o(e.detalleventa.numerointerno),1)]),t("div",pt,[_t,t("div",gt,o(e.detalleventa.numerocontrol),1)]),i(g,{style:{margin:"10px 0px"}}),t("table",yt,[t("tr",bt,[vt,t("td",wt,o(e.detalleventa.cliente),1)]),t("tr",xt,[t("td",null,o(e.detalleventa.abrev),1),t("td",Yt,o(e.detalleventa.documentosolo),1)]),t("tr",Vt,[Dt,t("td",Ct,o(e.detalleventa.fecha),1)]),t("tr",It,[Mt,t("td",Qt,o(e.detalleventa.usuario),1)])]),t("table",jt,[kt,(u(!0),h(b,null,M(e.ventas,a=>(u(),h(b,{key:a},[t("tr",Tt,[t("td",null,o(a.producto),1),t("td",Pt,o(Number(a.precio).toFixed(2)),1),t("td",Ft,o(a.cantidad),1),t("td",Nt,o(a.tasa)+"%",1),t("td",Bt,o(Number(a.subtotal).toFixed(2)),1)]),a.comentario&&a.comentario.length>0?(u(),h("tr",St,[t("td",At,[(u(!0),h(b,null,M(a.comentario.split("//"),p=>(u(),h(b,{key:p},[p.length>0?(u(),h("p",Ut,"- "+o(p),1)):y("",!0)],64))),128))]),$t,qt,zt,Ht])):y("",!0)],64))),128)),Et]),t("table",Lt,[t("tr",Rt,[Gt,t("td",null,"Subtotal "+o(e.prefijo)+":",1),t("td",Ot,o(e.detalleventa.subtotal),1)]),t("tr",Jt,[Kt,t("td",null,"Impuestos "+o(e.prefijo)+":",1),t("td",Wt,o(e.detalleventa.impuesto),1)]),t("tr",Xt,[Zt,t("td",null,"Descuentos "+o(e.prefijo)+":",1),t("td",te,o(e.detalleventa.descuentos.toFixed(2)),1)]),t("tr",ee,[ae,t("td",oe,"IGTF 3% "+o(e.prefijo)+":",1),t("td",se,o(e.detalleventa.igtf),1)]),t("tr",le,[ie,t("td",null,"Total "+o(e.prefijo)+":",1),t("td",ne,o(e.detalleventa.total),1)]),e.mostrartotal==="2"?(u(),h("tr",re,[de,t("td",null,"Total "+o(e.prefijo2)+":",1),t("td",ce,o(e.detalleventa.totalusd),1)])):y("",!0)])]),_:1}),i(g)]),ue,i(g),i(A,{align:"center"},{default:r(()=>[Y(i(f,{outline:"","no-caps":"",label:"Cancelar","icon-right":"close",color:"primary"},null,512),[[D]]),i(f,{unelevated:"","no-caps":"",label:"Imprimir",color:"primary","icon-right":"print",onClick:e.imprimir},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var De=T(z,[["render",he]]);export{De as default};
