import{_ as x,a9 as C,r as n,N as g,k as c,l as I,w as d,q as t,m as r,z as k,y as T,B as f,F as V,ab as s,t as j,Q,x as F,C as m,aw as u,ac as p,ay as v,ax as _,A as N,a6 as P,az as B}from"./index.2b5d0bf6.js";import{Q as D}from"./QBadge.1954e0ab.js";import{Q as w,a as S}from"./QTable.3bab8f3c.js";import{Q as $}from"./QPage.161e7907.js";import{C as A}from"./ClosePopup.0000aab8.js";import{h as z}from"./moment.40bc58bf.js";import{a as y}from"./axios.7331a07d.js";import"./format.80f30a37.js";import"./QSelect.c47f29f5.js";import"./QItem.114cbe0b.js";const b="https://posapi-test.factura-smart.com/",q=C({name:"IndexPage",setup(){return{modaldetalleinvoice:n(!1),prefijo:n("Bs."),prefijo2:n("$"),mostrartotal:n("1"),tipomoneda:n("1"),rows:n([]),ventas:n([]),cols:[{name:"accion",align:"left",label:"\u{1F527} Accion",field:"accion"},{name:"tipofactura",align:"center",label:"\u{1F4C3} Tipo Documento",field:"tipofactura"},{name:"numerointerno",align:"center",label:"\u{1F522} N\xB0 Interno",field:"numerointerno"},{name:"numerocontrol",align:"center",label:"\u{1F50D} # Control",field:"numerocontrol"},{name:"fecha",align:"center",label:"\u{1F4C5} Fecha",field:"fecha"},{name:"cliente",align:"left",label:"\u{1F468}\u200D\u{1F4BC} Cliente",field:"cliente"},{name:"documento",align:"left",label:"\u{1F194} Identificaci\xF3n",field:"documento"},{name:"usuario",align:"left",label:"\u{1F464} Usuario",field:"usuario"},{name:"subtotal",align:"left",label:"\u{1F4B2} Subtotal",field:"subtotal"},{name:"impuesto",align:"left",label:"\u{1F3DB} Impuesto",field:"impuesto"},{name:"total",align:"center",label:"\u{1F4B5} Total",field:"total"},{name:"estatus",align:"center",label:"\u{1F504} Estatus",field:"estatus"}],filterTable:n(""),empresa:n(""),direccion:n(""),rif:n(""),telefono:n(""),email:n(""),buscaritem:n(!1),detalleventa:n({}),loading:n(!1),id_usuario:n(sessionStorage.getItem("id_usuario")),co_rol:n(sessionStorage.getItem("co_rol")),pagination:{page:1,rowsPerPage:20}}},methods:{imprimir(){window.frames.print_frame.document.body.innerHTML=document.getElementById("areaImprimir").innerHTML,window.frames.print_frame.window.focus(),window.frames.print_frame.window.print(),this.modaldetalleinvoice=!1},async abrirDetalleInvoive(e){console.log(e),this.detalleventa=e,await y.get(b+"ventas/getitemsventas/"+e.cod).then(async a=>{this.ventas=a.data.resp;for(const o in this.holds){const l=this.ventas[o];this.ventas.push(l)}}).catch(a=>{g.create("Problemas al listar items Ventas "+a)}),this.modaldetalleinvoice=!0},listar(){this.btndisable=!1,y.get(b+"ventas/getventas/"+sessionStorage.getItem("co_empresa")).then(async e=>{console.log(e.data);const a=e.data.resp;this.rows=[];for(const o in a){const l={};l.cod=a[o].id,l.numerointerno=a[o].numerointerno,l.numerocontrol=a[o].numerocontrol,l.fecha=z(a[o].fecha).format("DD/MM/YYYY HH:mm:ss"),l.subtotal=a[o].subtotal?a[o].subtotal.toFixed(2):"0.00",l.impuesto=a[o].impuesto?a[o].impuesto.toFixed(2):"0.00",l.total=a[o].total?a[o].total.toFixed(2):"0.00",l.totalusd=a[o].totalusd?a[o].totalusd.toFixed(2):"0.00",l.igtf=a[o].igtf?a[o].igtf.toFixed(2):"0.00",l.descuentos=a[o].descuentos,l.usuario=a[o].usuario,l.documentosolo=a[o].documento,l.documento=a[o].abrev+"-"+a[o].documento,l.cliente=a[o].nombrecliente,l.abrev=a[o].abrev,l.tipofactura=a[o].tipofactura,l.estatus=a[o].estatus,this.co_rol==="3"?a[o].idusuario===this.id_usuario&&this.rows.push(l):this.rows.push(l)}console.log(this.rows)}).catch(e=>{g.create("Problemas al listar Ventas "+e)})},async cargar(){const a=(await y.get(b+"configuracion/"+sessionStorage.getItem("co_empresa")).catch(o=>{g.create("Problemas al listar Configuracion "+o)})).data.resp;this.empresa=a.empresa,this.rif=a.rif,this.direccion=a.direccion,this.telefono=a.telefono,this.email=a.email,this.tipomoneda=a.tipomoneda,this.prefijo=a.tipomoneda==="1"?"Bs.":"$",this.prefijo2=a.tipomoneda==="1"?"$":"Bs.",this.mostrartotal=a.mostrartotal}},mounted(){this.cargar(),this.listar()}}),H={class:"col"},M=t("div",{class:"botones row fondo-gris shadow-up-9"},[t("h6",{class:"p-2"},"Reporte de Ventas")],-1),E={class:"listarcategorias row",style:{margin:"20px 0 10px 0"}},L={class:"row",style:{height:"74vh",overflow:"auto"}},U={class:"col"},Y={class:"row justify-center"},R={style:{display:"inline"}},G={class:"text-center"},O={align:"center"},J={id:"areaImprimir",style:{width:"100%"}},K={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},W={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},X={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},Z={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},tt={class:"text-center letratotalesfactura",style:{"line-height":"10px"}},et={key:0,class:"anulada",style:{display:"flex","justify-content":"center","align-items":"center",width:"100%"}},at={style:{display:"flex","align-items":"left",width:"100%"}},st={class:"numero",style:{"margin-left":"10px"}},ot={class:"numero",style:{"margin-left":"10px"}},lt={style:{display:"flex","align-items":"center"}},it=t("div",{class:"control",style:{"margin-left":"10px"}}," N\xB0 de control:",-1),nt={class:"control",style:{"margin-left":"10px"}},rt={style:{width:"100%"}},dt={class:"letratotalesfactura",style:{"line-height":"10px"}},ct=t("td",{style:{width:"30%"}},"Raz\xF3n social:",-1),ut={style:{"font-weight":"bold"}},ht={class:"letratotalesfactura",style:{"line-height":"10px"}},ft={style:{"font-weight":"bold"}},mt={class:"letratotalesfactura",style:{"line-height":"10px"}},pt=t("td",null,"Fecha:",-1),_t={style:{"font-weight":"bold"}},gt={class:"letratotalesfactura",style:{"line-height":"10px"}},yt=t("td",null,"Cajero:",-1),bt={style:{"font-weight":"bold"}},vt={style:{width:"100%"}},wt=t("tr",{style:{"font-weight":"bold","font-size":"11px"}},[t("td",{class:"rayafactura rayaarriba",style:{width:"130px"}},"Producto"),t("td",{class:"rayafactura rayaarriba",style:{"text-align":"right"}},"Precio"),t("td",{class:"rayafactura rayaarriba"},"Cant."),t("td",{class:"rayafactura rayaarriba"},"Imp %"),t("td",{class:"rayafactura rayaarriba",style:{"text-align":"right"}},"Total")],-1),xt={style:{"font-size":"11px"}},Ct={style:{"text-align":"right"}},It={style:{"text-align":"center"}},kt={style:{"text-align":"center"}},Tt={style:{"text-align":"right"}},Vt={key:0,style:{"line-height":"10px"}},jt={style:{"font-style":"italic","font-size":"9px"}},Qt={key:0},Ft=t("td",null,null,-1),Nt=t("td",null,null,-1),Pt=t("td",null,null,-1),Bt=t("td",null,null,-1),Dt=t("tr",null,[t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"}),t("td",{class:"rayafactura"})],-1),St={style:{width:"100%"}},$t={class:"letratotalesfactura",style:{"line-height":"10px"}},At=t("td",{style:{width:"40%"}},null,-1),zt={style:{"text-align":"right"}},qt={class:"letratotalesfactura",style:{"line-height":"10px"}},Ht=t("td",null,null,-1),Mt={style:{"text-align":"right"}},Et={class:"letratotalesfactura",style:{"line-height":"10px"}},Lt=t("td",null,null,-1),Ut={style:{"text-align":"right"}},Yt={class:"letratotalesfactura",style:{"line-height":"10px"}},Rt=t("td",null,null,-1),Gt={class:"rayafactura"},Ot={class:"rayafactura",style:{"text-align":"right"}},Jt={class:"letratotalesfactura",style:{"font-weight":"bold"}},Kt=t("td",null,null,-1),Wt={style:{"text-align":"right"}},Xt={key:0,class:"letratotalesfactura",style:{"font-weight":"bold"}},Zt=t("td",null,null,-1),te={style:{"text-align":"right"}},ee=t("iframe",{name:"print_frame",width:"0",height:"0",frameborder:"0",src:"about:blank"},null,-1);function ae(e,a,o,l,se,oe){return c(),I($,{class:"row"},{default:d(()=>[t("div",H,[M,t("div",E,[r(T,{color:"blue-grey-3","bg-color":"white",outlined:"",standout:"",dense:"",debounce:"500",modelValue:e.filterTable,"onUpdate:modelValue":a[0]||(a[0]=i=>e.filterTable=i),placeholder:"Buscar",style:{width:"320px"}},{append:d(()=>[r(k,{name:"search"})]),_:1},8,["modelValue"])]),t("div",L,[t("div",U,[t("div",Y,[r(S,{rows:e.rows,title:"Ventas",columns:e.cols,"row-key":"num",pagination:e.pagination,dense:"",style:{width:"95%",margin:"20px"},loading:e.loading,filter:e.filterTable,"no-data-label":"\u26A0 Sin registros ","wrap-cells":"",separator:"cell",class:"custom-shadow custom-border-radius-table"},{"top-right":d(()=>[t("div",R,[r(f,{"icon-right":"filter_list",class:"q-ml-sm col-md-4 col-sm-3 col-xs-3",unelevated:"",rounded:"",color:"orange-1","text-color":"orange-10",label:"Filtrar",onClick:a[1]||(a[1]=i=>e.drawerFilters=!0)})])]),"body-cell-estatus":d(i=>[r(w,{props:i},{default:d(()=>[t("div",G,[r(D,{color:i.row.estatus==="1"?"green-1":"red-1","text-color":i.row.estatus==="1"?"green-9":"red-9",class:"q-mt-xs q-mr-xs q-pa-xs",rounded:""},{default:d(()=>[V(s(i.row.estatus==="1"?"Procesada":"Anulada"),1)]),_:2},1032,["color","text-color"])])]),_:2},1032,["props"])]),"body-cell-accion":d(i=>[r(w,{props:i},{default:d(()=>[t("div",O,[r(f,{round:"",unelevated:"",color:"orange-1","text-color":"orange-10",icon:"plagiarism",dense:"",onClick:j(h=>e.abrirDetalleInvoive(i.row),["stop"])},null,8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading","filter"])])])])]),r(B,{modelValue:e.modaldetalleinvoice,"onUpdate:modelValue":a[2]||(a[2]=i=>e.modaldetalleinvoice=i),persistent:""},{default:d(()=>[r(Q,{style:{width:"320px"}},{default:d(()=>[t("div",J,[r(F,{style:{"justify-content":"center"}},{default:d(()=>[t("div",K,s(e.empresa),1),t("div",W,s(e.rif),1),t("div",X,s(e.direccion),1),t("div",Z,s(e.telefono),1),t("div",tt,s(e.email),1),r(m,{style:{margin:"10px 0px"}}),e.detalleventa.estatus==="2"?(c(),u("div",et,"ANULADA")):p("",!0),t("div",at,[t("div",st,s(e.detalleventa.tipofactura),1),t("div",ot,s(e.detalleventa.numerointerno),1)]),t("div",lt,[it,t("div",nt,s(e.detalleventa.numerocontrol),1)]),r(m,{style:{margin:"10px 0px"}}),t("table",rt,[t("tr",dt,[ct,t("td",ut,s(e.detalleventa.cliente),1)]),t("tr",ht,[t("td",null,s(e.detalleventa.abrev),1),t("td",ft,s(e.detalleventa.documentosolo),1)]),t("tr",mt,[pt,t("td",_t,s(e.detalleventa.fecha),1)]),t("tr",gt,[yt,t("td",bt,s(e.detalleventa.usuario),1)])]),t("table",vt,[wt,(c(!0),u(_,null,v(e.ventas,i=>(c(),u(_,{key:i},[t("tr",xt,[t("td",null,s(i.producto),1),t("td",Ct,s(Number(i.precio).toFixed(2)),1),t("td",It,s(i.cantidad),1),t("td",kt,s(i.tasa)+"%",1),t("td",Tt,s(Number(i.subtotal).toFixed(2)),1)]),i.comentario&&i.comentario.length>0?(c(),u("tr",Vt,[t("td",jt,[(c(!0),u(_,null,v(i.comentario.split("//"),h=>(c(),u(_,{key:h},[h.length>0?(c(),u("p",Qt,"- "+s(h),1)):p("",!0)],64))),128))]),Ft,Nt,Pt,Bt])):p("",!0)],64))),128)),Dt]),t("table",St,[t("tr",$t,[At,t("td",null,"Subtotal "+s(e.prefijo)+":",1),t("td",zt,s(e.detalleventa.subtotal),1)]),t("tr",qt,[Ht,t("td",null,"Impuestos "+s(e.prefijo)+":",1),t("td",Mt,s(e.detalleventa.impuesto),1)]),t("tr",Et,[Lt,t("td",null,"Descuentos "+s(e.prefijo)+":",1),t("td",Ut,s(e.detalleventa.descuentos.toFixed(2)),1)]),t("tr",Yt,[Rt,t("td",Gt,"IGTF 3% "+s(e.prefijo)+":",1),t("td",Ot,s(e.detalleventa.igtf),1)]),t("tr",Jt,[Kt,t("td",null,"Total "+s(e.prefijo)+":",1),t("td",Wt,s(e.detalleventa.total),1)]),e.mostrartotal==="2"?(c(),u("tr",Xt,[Zt,t("td",null,"Total "+s(e.prefijo2)+":",1),t("td",te,s(e.detalleventa.totalusd),1)])):p("",!0)])]),_:1}),r(m)]),ee,r(m),r(N,{align:"center"},{default:d(()=>[P(r(f,{outline:"","no-caps":"",label:"Cancelar","icon-right":"close",color:"primary"},null,512),[[A]]),r(f,{unelevated:"","no-caps":"",label:"Imprimir",color:"primary","icon-right":"print",onClick:e.imprimir},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var pe=x(q,[["render",ae]]);export{pe as default};
